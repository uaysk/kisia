# 프로젝트명
경량화된 UEM 기반 제로 트러스트 신뢰도 점수 산정 모델 및 접근 제어 구현

# **프로젝트 개요**

여러 가지 사용자 기반의 정보들을 이용하여 신뢰도 점수를 산정하는 모델을 만들고 점수에 따른 사용자 접근 허용 또는 거부 시스템 / 전체 소켓통신, 미들웨어 접근 제어에 대한 시각화 및 대시보드 구현

# 문제 정의 및 필요성	

기존 보안 모델의 한계: 전통적인 보안 모델은 외부 네트워크와 내부 네트워크를 명확히 구분하여, 일단 내부로 진입한 사용자는 신뢰하는 경향이 있습니다. 그러나 이는 내부자에 의한 위협이나 악성코드의 횡적 이동(Lateral Movement)에 취약합니다.

다양한 접근 환경: 클라우드, 원격 근무 환경의 확산으로 사용자들이 다양한 디바이스와 네트워크를 통해 시스템에 접근하면서, '신뢰할 수 있는 내부'라는 개념이 모호해졌습니다.

실시간 모니터링 부재: 사용자의 로그인 이후의 행동이나 디바이스의 보안 상태 변화를 실시간으로 감지하고 대응하는 시스템이 부족합니다. 단순히 '로그인 성공' 여부만으로 접근을 허용하는 것은 보안 위협을 증가시킵니다.

수동적 대응: 보안 위협 발생 시 사후 대응에 초점을 맞추는 경향이 있어, 능동적인 위협 예방 및 선제적 조치가 어렵습니다.

# 목표 및 기대 효과

- 목표:
    - 사용자와 디바이스의 신뢰 점수(Trust Score)를 실시간으로 산정
    - 점수에 따라 미들웨어 접근을 동적으로 제어함으로써 시스템에 적용
    - 전체 소켓통신, 미들웨어 접근 제어에 대한 시각화 및 대시보드 제작

- 기대효과:
    - 보안 강화 및 위협 감소: 
	사용자의 신원을 확인하는 다양한 요소를 종합적으로 평가하여 비정상적인 접근을 사전에 차단함으로써 내부 위협 및 데이터 유출 가능성을 최소화합니다.

    - 가시성 확보: 
	전체 시스템의 보안 현황, 클라이언트 접속 상태, 접근 제어 이력 등을 시각화된 대시보드를 통해 실시간으로 파악하여 관리자의 효율적인 모니터링을 지원합니다.

    - 자동화된 대응: 
    위험 요소 발견 시, 지속적 상태 재검증을 통해 관리자의 개입 없이도 신속하게 문제를 해결할 수 있는 기반을 마련합니다.

# 주요 기능 및 기술

1. UEM Agent

- 제로트러스트 신뢰도 점수 산정에 필요한 정보를 UEM 서버로 보냅니다.

2. UEM Sever/ML

- 사용자 행위 데이터와 디바이스 정보를 수집, 관리하는 중앙 서버입니다. 에이전트로부터 데이터를 수신하고, 이를 기반으로 신뢰도 점수 산정 모델을 운영합니다.

- Trust Score = (w1 * p1) + (w2 * p2) + ... + (Wn * pn) / p1 + p2 + ... + pn
* p1, p2, pn = 신뢰를 평가하는 여러 요소 (예:IP주소, 사용자 이름 및 역할, 위치, 시간, 장치 상태 등)
* w1, w2, wn = 각 요소에 할당된 가중치, 해당 요소가 신뢰점수에 미치는 상대적인 중요도를 나타냄
                

- UEM Server는 수집된 데이터를 머신러닝 기반의 신뢰도 점수 산정 모델에 입력하여 0에서 100까지의 신뢰도 점수를 산정합니다. 

- 이상 행동 감지: 평소와 다른 비정상적인 접근 패턴(예: 심야 시간대 공유 폴더 대량 접근)은 점수를 낮춥니다. 

- 보안 정책 준수: 최신 OS 패치 적용, 백신 정상 작동 등 보안 정책을 잘 지키고 있으면 점수를 높입니다.

판단 알고리즘: 사용자의 역할(일반 사용자, 보안 담당자 등)에 따른 기본 점수와, 보안 상태에 따른 가점/감점을 종합하여 Trust Score를 산정합니다.

접근 제어: 산정된 Trust Score가 사전에 정의된 기준 점수(예: 일반 사용자 70점)를 만족하는지에 따라 미들웨어 접근을 허용하거나 차단합니다.

재검증: 매 요청마다 실시간 검증을 하고 로그인 세션 중에 3~5분 간격으로 상태 재검증을 하여 기준 점수의 변동으로 인해 허용 점수에 충족되지 않을 경우 접근을 차단합니다.

4. Auth Server

- UEM 서버로부터 신뢰도 점수를 받으면 받은 점수를 기준으로 접근 허용/차단 여부를 판단하여 서버 프록시로 보냅니다.

5. Proxy

- 유저의 요청을 받습니다.

- 인증 서버로부터 받은 점수 기반 접근 허용/차단 여부를 통해 사용자를 Application에 연결해줍니다.

6. User DB

- User ID/PW를 저장하고 관리합니다.

- UEM Agent와 Login App에 User ID/PW를 전달합니다.

7. Login App 

- User가 Login Page에 접근하면 User DB로부터 User ID/PW를 받아서 확인 후 User ID/Token을 Auth Server로 보냅니다.

8. 시각화 대시보드

- grafana+prometheus+nginx log exporter 조합으로 로그 수집 후 403, 200 메시지 수집 후 사용자에게 표시, 사용자가 보낸
요청의 위치를 GeoLite2-City를 통해 시각화

# 시나리오

#재택근무
- 개인 노트북으로 업무 시스템에 접근
- 재택근무 시에 보안이 취약한 가정용 와이파이로 접근
- 퇴근 후 재택에서 야간에 접속
- 재택근무 시에 권한 없는 리소스 접근
#외부인과 근무 시
- 사내 협업 툴에 외부인 초대
#해외 출장 시나리오
- 해외 위치 정보 기반으로 접근 제한
- 해외에서 도난당한 장치로 접속 시도
#원격지 시나리오
- 해외 위치 정보 기반으로 접근 제한
- 업무용 태블릿의 OS 변조 감지
- 카페에서 공용 와이파이 접속
- 기차 등 이동 중에 해당 공용 와이파이로 접속
- 피싱 공격으로 탈취된 계정으로 접근 시도
- 개인 스마트폰으로 시스템 접근

# 지표

### 제로트러스트 신뢰도 점수 산정 지표 ###

 
① 사용자(User) 지표

인증 방식: MFA 사용 여부, 성공/실패 기록, 응답 속도

로그인 성공/실패율: 비정상 로그인 시도 횟수, 계정 잠금 빈도

로그인 위치: 평소 위치 대비 이상 위치(IP/GeoIP 기반)

업무 시간 외 로그인: 심야, 주말 등 비정상 시간대 로그인 빈도 (다른 지표와 복합지표로 사용, 오탐을 줄이기 위함)

동시 로그인 세션: 여러 지역/장치에서 동시에 로그인 발생 여부

권한 수준: 관리자 권한 계정 여부, RBAC(Role-Based Access Control) 준수 여부



② 디바이스(Device) 지표

디바이스 등록 여부: 관리형(회사 등록)/비관리형 구분

기기 식별자: 에이전트 ID, 브라우저/디바이스 핑거프린트

OS/패치 최신화 여부: OS 버전, 보안 패치 최신 상태

보안 소프트웨어 상태: 백신/EDR 설치 및 실행 여부

디스크 암호화 여부: BitLocker/FileVault 적용 여부

루팅/탈옥 여부: 무결성 검증 실패 여부

개인 방화벽 활성화 여부



③ 네트워크(Network) 지표

VPN/프록시/TOR 여부

세션 보안: TLS 암호화 여부, 중간자 공격(MiTM) 탐지

접속 패턴: 평소 대비 급격히 증가한 연결 요청 수

데이터 전송량: 정상 범위 이상 대량 데이터 전송 여부

로그인 시도 IP 검증: 블랙리스트/평판 기반 검증

접속 위치/국가: 정상 지역 대비 이상 지역 여부

네트워크 유형: 사설망/집/공용 Wi-Fi 구분



④ 환경 일관성(Environment Consistency)

OS/브라우저 언어 설정

타임존: 위치/행동과 불일치 여부



⑤ 세션(Session) 지표

브라우저/앱 UA 해시

마지막 정상 로그인 시각

세션 지속성: 동시 세션 수, 비정상 로그아웃 여부



⑥ 행위(Behavior) 지표

로그인 시간 패턴: 근무 시간/야간 구분 (다른 지표와 복합 활용)
* 예시
  '야간 로그인' + '평소 사용하지 않는 새로운 기기(device_id)'
  '야간 로그인' + '평소 접속하지 않던 새로운 국가/IP(geo_country, src_ip)'
  '야간 로그인' + '로그인 시도 횟수 증가(failed_attempts_recent)'

행동 패턴 변화: 로그인 위치, 장치, 사용 앱 등 평소와의 편차

비정상 명령 실행: 관리자 권한 실행, PowerShell/스크립트 실행 기록

내부 이동(Lateral Movement): 평소 접근하지 않던 서버/시스템 접근

권한 상승 시도: 불필요한 admin 권한 요청 여부

데이터 접근 다양성: 다양한 부서/프로젝트 자원 동시 접근 여부



⑦ 리소스/애플리케이션(Resource & Application) 지표

공유 폴더 접근 빈도: 평소 대비 비정상적 접근 증가

DB 접근 기록: 민감 DB/ERP/HR 시스템 조회 빈도

클라우드 SaaS 접근: O365, GDrive 등 접근 로그

API 호출 빈도: 비정상적으로 많은 API 호출

파일 다운로드/업로드 횟수: 평소보다 증가 여부



⑧ 보강(Additional/Contextual) 지표

정책 준수 여부: DLP 정책 위반, USB 연결 여부

위협 인텔리전스 연계: 알려진 악성 도메인 접속 여부

사용자 신뢰 레벨: 입사 경과일, 계약직/정규직 여부 (내부 위험도 가중치)


# 프로젝트 구조도

<img width="2630" height="2424" alt="프로젝트 구조도" src="https://github.com/user-attachments/assets/c75ffb88-9123-4259-a5c1-a7b321cffb4f" />


[사용자: 홍길동]
        │
        ▼
  [ID / PW 입력]
        │
        ▼
 ┌───────────────────────┐
 │ Zero Trust Score 계산 │
 └───────────────────────┘
        │
        ▼
   [ZT Score = 85 / 100점]
        │
        ▼
 ┌───────────────────────────────────────┐
 │ 접근 정책 확인 (예: 개발자 포털 ≥ 90점) │
 └───────────────────────────────────────┘
        │
   ┌────┴──────┐
   │           │
   ▼           ▼
[거부: No!]  [세션 유지 시나리오]
                 │
                 ▼
      ┌────────────────────────────┐
      │ 세션 중 3~5분마다 ZT 재검증 │
      └────────────────────────────┘
                 │
                 ▼
         [85점 → 84점 하락]
                 │
                 ▼
      ┌────────────────────────┐
      │ 조건 미충족 → 세션 Kill │
      └────────────────────────┘
